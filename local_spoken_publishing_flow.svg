<?xml version="1.0" encoding="UTF-8"?>
<svg width="1200" height="760" viewBox="0 0 1200 760" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style><![CDATA[
      .box { fill: #ffffff; stroke: #111827; stroke-width: 2; rx: 18; ry: 18; }
      .subbox { fill: #f9fafb; stroke: #111827; stroke-width: 2; rx: 14; ry: 14; }
      .text { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Inter, Arial, sans-serif; fill: #111827; }
      .h1 { font-size: 22px; font-weight: 700; }
      .h2 { font-size: 16px; font-weight: 700; }
      .p  { font-size: 14px; font-weight: 400; }
      .small { font-size: 12px; opacity: 0.9; }
      .arrow { stroke: #111827; stroke-width: 2.5; fill: none; marker-end: url(#arrowhead); }
      .dashed { stroke-dasharray: 6 6; }
      .badge { fill: #111827; }
      .badgeText { fill: #ffffff; font-size: 12px; font-weight: 700; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Inter, Arial, sans-serif; }
    ]]></style>
    <marker id="arrowhead" markerWidth="10" markerHeight="8" refX="9" refY="4" orient="auto">
      <polygon points="0,0 10,4 0,8" fill="#111827"/>
    </marker>
  </defs>

  <text x="60" y="64" class="text h1">Local Spoken Publishing Pipeline (macOS + Apple Silicon)</text>
  <text x="60" y="92" class="text p">Drop audio → get transcript → optional WordPress draft (intent-gated)</text>

  <rect x="60" y="120" width="520" height="46" class="subbox"/>
  <text x="82" y="149" class="text h2">Transcription lane (rock-solid)</text>

  <rect x="620" y="120" width="520" height="46" class="subbox"/>
  <text x="642" y="149" class="text h2">Publishing lane (safe glue)</text>

  <rect x="60" y="190" width="520" height="92" class="box"/>
  <text x="82" y="222" class="text h2">1) Watch folder for audio</text>
  <text x="82" y="246" class="text p">LaunchAgent starts on login</text>
  <text x="82" y="268" class="text small">Input: _00_To_Be_Processed/*</text>

  <rect x="60" y="310" width="520" height="110" class="box"/>
  <text x="82" y="342" class="text h2">2) Normalize audio to WAV</text>
  <text x="82" y="366" class="text p">ffmpeg → 16kHz mono PCM for whisper.cpp</text>
  <text x="82" y="388" class="text small">m4a/mp3/etc → .wav (temp), then cleaned up</text>

  <rect x="60" y="450" width="520" height="120" class="box"/>
  <text x="82" y="482" class="text h2">3) Transcribe with Metal GPU</text>
  <text x="82" y="506" class="text p">whisper-cli + ggml-medium.bin (local model)</text>
  <text x="82" y="528" class="text small">Output: _02_Transcripts/&lt;name&gt;.txt (with timestamps)</text>

  <rect x="60" y="600" width="520" height="120" class="box"/>
  <text x="82" y="632" class="text h2">4) Add footer + checksum</text>
  <text x="82" y="656" class="text p">Provenance tagline + word count</text>
  <text x="82" y="678" class="text small">Checksum prevents double-append on re-runs</text>

  <rect x="620" y="190" width="520" height="120" class="box"/>
  <text x="642" y="222" class="text h2">5) Detect publishing intent</text>
  <text x="642" y="246" class="text p">Only posts if spoken contract is present</text>
  <text x="642" y="270" class="text small">Requires: “Meta note” + (“Create blog post” or “Create a blog post”)</text>

  <rect x="620" y="340" width="520" height="120" class="box"/>
  <text x="642" y="372" class="text h2">6) Parse front-matter</text>
  <text x="642" y="396" class="text p">Title / Excerpt / Tags (spoken or derived)</text>
  <text x="642" y="418" class="text small">Strips timestamps + footer by default for WordPress</text>

  <rect x="620" y="490" width="520" height="120" class="box"/>
  <text x="642" y="522" class="text h2">7) Create WordPress draft</text>
  <text x="642" y="546" class="text p">WP REST API + App Password</text>
  <text x="642" y="568" class="text small">Categories: unassigned • Tags: ensured/created</text>

  <rect x="620" y="640" width="520" height="80" class="box"/>
  <text x="642" y="672" class="text h2">Result</text>
  <text x="642" y="696" class="text p">Draft waiting in WordPress, ready for edits</text>

  <path d="M320 282 L320 310" class="arrow"/>
  <path d="M320 420 L320 450" class="arrow"/>
  <path d="M320 570 L320 600" class="arrow"/>

  <path d="M580 660 C650 660 590 250 620 250" class="arrow dashed"/>
  <text x="510" y="708" class="text small">handoff: transcript .txt</text>

  <path d="M880 310 L880 340" class="arrow"/>
  <path d="M880 460 L880 490" class="arrow"/>
  <path d="M880 610 L880 640" class="arrow"/>

  <rect x="60" y="720" width="250" height="26" rx="13" ry="13" class="badge"/>
  <text x="75" y="739" class="badgeText">Local-first • No subscriptions</text>

  <rect x="330" y="720" width="250" height="26" rx="13" ry="13" class="badge"/>
  <text x="345" y="739" class="badgeText">Metal GPU • whisper.cpp</text>

  <rect x="600" y="720" width="280" height="26" rx="13" ry="13" class="badge"/>
  <text x="615" y="739" class="badgeText">Intent-gated publishing contract</text>

  <rect x="900" y="720" width="240" height="26" rx="13" ry="13" class="badge"/>
  <text x="915" y="739" class="badgeText">WP Draft via REST API</text>
</svg>
